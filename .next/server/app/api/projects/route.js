(()=>{var e={};e.id=64,e.ids=[64],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1630:e=>{"use strict";e.exports=require("http")},1997:e=>{"use strict";e.exports=require("punycode")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4075:e=>{"use strict";e.exports=require("zlib")},4474:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>g,routeModule:()=>j,serverHooks:()=>f,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>m});var t={};s.r(t),s.d(t,{DELETE:()=>l,GET:()=>u,PATCH:()=>d,POST:()=>p});var o=s(6559),n=s(8088),i=s(7719),a=s(2190);let c=(0,s(1453).UU)("https://qwumsqzcfjurbwrjxuoe.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function u(){try{let{data:e,error:r}=await c.from("projects").select("*").order("pinned",{ascending:!1}).order("created_at",{ascending:!1});if(r)return console.error("Supabase fetch error:",r),a.NextResponse.json({success:!1,error:r.message},{status:500});return a.NextResponse.json({success:!0,projects:e.map(e=>({id:e.id,title:e.title,description:e.description,demoLink:e.demo_link,image:e.image_url,pinned:e.pinned||!1,createdAt:e.created_at,updatedAt:e.updated_at}))})}catch(e){return console.error("Error in GET handler:",e),a.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function p(e){try{let{title:r,description:s,demoLink:t,imageUrl:o,pinned:n=!1}=await e.json();if(!r||!s||!t)return a.NextResponse.json({success:!1,error:"Title, description, and demo link are required"},{status:400});let{data:i,error:u}=await c.from("projects").insert([{title:r,description:s,demo_link:t,image_url:o||null,pinned:n}]).select();if(u)return console.error("Supabase insert error:",u),a.NextResponse.json({success:!1,error:u.message},{status:500});return a.NextResponse.json({success:!0,project:{id:i[0].id,title:i[0].title,description:i[0].description,demoLink:i[0].demo_link,image:i[0].image_url,pinned:i[0].pinned||!1,createdAt:i[0].created_at}})}catch(e){return console.error("Error in POST handler:",e),a.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function d(e){try{let{id:r,title:s,description:t,demoLink:o,imageUrl:n,pinned:i}=await e.json();if(console.log("PATCH request received:",{id:r,title:s,description:t,demoLink:o,imageUrl:n,pinned:i}),!r)return a.NextResponse.json({success:!1,error:"Project ID is required"},{status:400});let u={updated_at:new Date().toISOString()};if(void 0!==s&&(u.title=s),void 0!==t&&(u.description=t),void 0!==o&&(u.demo_link=o),void 0!==n&&(u.image_url=n),void 0!==i){if(!0===i){let{count:e,error:s}=await c.from("projects").select("*",{count:"exact",head:!0}).eq("pinned",!0);if(s)return console.error("Count error:",s),a.NextResponse.json({success:!1,error:s.message},{status:500});let{data:t,error:o}=await c.from("projects").select("pinned").eq("id",r).single();if(o)return console.error("Current project fetch error:",o),a.NextResponse.json({success:!1,error:o.message},{status:500});let n=e??0;if((t?.pinned?n-1:n)>=100)return a.NextResponse.json({success:!1,error:"Maximum of 6 projects can be pinned"},{status:400})}u.pinned=i}console.log("Updating project with data:",u);let{data:p,error:d}=await c.from("projects").update(u).eq("id",r).select();if(d)return console.error("Supabase update error:",d),a.NextResponse.json({success:!1,error:d.message},{status:500});if(!p||0===p.length)return a.NextResponse.json({success:!1,error:"Project not found"},{status:404});let l=p[0];return console.log("Project updated successfully:",l),a.NextResponse.json({success:!0,project:{id:l.id,title:l.title,description:l.description,demoLink:l.demo_link,image:l.image_url,pinned:l.pinned||!1,createdAt:l.created_at,updatedAt:l.updated_at}})}catch(e){return console.error("Error in PATCH handler:",e),a.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function l(e){try{let{searchParams:r}=new URL(e.url),s=r.get("id");if(!s)return a.NextResponse.json({success:!1,error:"Project ID is required"},{status:400});let{error:t}=await c.from("projects").delete().eq("id",s);if(t)return console.error("Supabase delete error:",t),a.NextResponse.json({success:!1,error:t.message},{status:500});return a.NextResponse.json({success:!0,message:"Project deleted successfully"})}catch(e){return console.error("Error in DELETE handler:",e),a.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let j=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/projects/route",pathname:"/api/projects",filename:"route",bundlePath:"app/api/projects/route"},resolvedPagePath:"C:\\Users\\ADMIN\\Desktop\\workspace\\boyalonetech\\src\\app\\api\\projects\\route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:x,workUnitAsyncStorage:m,serverHooks:f}=j;function g(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:m})}},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5591:e=>{"use strict";e.exports=require("https")},6487:()=>{},7910:e=>{"use strict";e.exports=require("stream")},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[447,453,580],()=>s(4474));module.exports=t})();